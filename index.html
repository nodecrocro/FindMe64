<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title> Meow Meow Meow Meow </title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="description" content="CTF practice: find the hidden flag (category: open, difficulty: medium -> harder)">

  <style>
    :root{--accent:#2b6cb0;--bg:#0f172a;--card:#0b1220;--glass:rgba(255,255,255,0.03)}
    html,body{height:100%;margin:0;font-family:Inter,system-ui,Arial,sans-serif;background:linear-gradient(180deg,var(--bg) 0%, #071024 100%);color:#e6eef8}
    .wrap{min-height:100%;display:flex;align-items:center;justify-content:center;padding:3rem}
    .card{width:900px;max-width:95%;background:linear-gradient(180deg,var(--card),#071428);border-radius:12px;padding:28px;box-shadow:0 10px 30px rgba(2,6,23,0.7);border:1px solid rgba(255,255,255,0.03)}

    /* small submit styles */
    .flag-row{margin-top:16px;display:flex;gap:8px;align-items:center}
    .flag-input{flex:1;padding:8px;border-radius:6px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit;font-family:inherit}
    .flag-btn{padding:8px 12px;border-radius:6px;border:0;background:var(--accent);color:#07203a;font-weight:600;cursor:pointer}
    .flag-msg{margin-top:10px;font-size:0.95rem}

    .easter::after{
      /
      content: "\63\33\51\7A\5A\55\46\73\58\30\31\35"; 
      display:block;opacity:0;font-size:0.75rem;pointer-events:none;user-select:none
    }
    .stealth::before{
     
      content: "\58\33\49\77\59\6E\56\34\66\51\3D\3D"; 
      display:block;opacity:0;pointer-events:none;user-select:none
    }

    
    .svg-decoy{position:absolute;left:-9999px;top:-9999px}

    .console{background:#071326;border-radius:8px;padding:10px;margin-top:12px;color:#d7eef9;font-family:monospace;min-height:80px}
    .decode-btn{background:transparent;border:1px solid rgba(255,255,255,0.06);padding:8px 12px;border-radius:6px;color:var(--accent);cursor:pointer}
    .decode-btn:hover{background:rgba(255,255,255,0.02)}
    .small{font-size:0.85rem;color:#9fb6ea}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>Find Nazran Hidden Mesaage</h1>
      <p class="lead">Category: <strong>chef</strong> — Difficulty: <strong>very easy</strong></p>

      <div class="columns">
        <div class="col">
          <div class="hint">
            <strong>Challenge</strong>
            <p class="small">We found out that nazran secretly hiding a hidden message in his website about his robux location. Can you help us finding the hidden message?</p>
          </div>

          <div style="margin-top:12px" class="console" id="console">
            <div class="small">Console: try your commands here (does not reveal the flag automatically).</div>
            <div style="margin-top:8px">
              <button class="decode-btn" id="hintBtn">Get a gentle hint</button>
            </div>
            <div id="hintArea" class="small" style="margin-top:8px;color:#bcd7ff"></div>
          </div>

          <!-- FLAG SUBMIT UI: added here so it appears inside the card -->
          <div class="flag-row" aria-label="flag-submit">
            <input id="flagInput" class="flag-input" type="text" placeholder="Enter flag here (FLAG{...})" autocomplete="off" />
            <button id="flagSubmit" class="flag-btn">Submit</button>
          </div>
          <div id="flagMsg" class="flag-msg" aria-live="polite"></div>
          <!-- end submit UI -->

        </div>

          <div style="margin-top:12px" class="hint">
            <strong>Extra</strong>
            <p class="small">This page intentionally scatters the pieces: one is reversed inside a comment, another is in hex-escaped CSS content split across two selectors, and one is tucked inside an SVG description with a tiny junk char to remove. Inspect raw source carefully.</p>
          </div>
        </div>
      </div>

      <div class="footer">
        <span>Author: Nazware</span> — <span>Good luck!</span>
      </div>

      <!--
        partA reversed: fRnbwQ2e6FmT
      -->

 
      <span class="easter" style="position:absolute; left:-9999px; top:-9999px;">.</span>
      <span class="stealth" style="position:absolute; left:-9999px; top:-9999px;">.</span>

      
      <svg class="svg-decoy" xmlns="http://www.w3.org/2000/svg" width="1" height="1" aria-hidden="true">
        <desc>X3Iw!YnV4fQ==</desc>
       
      </svg>

    </div>
  </div>

  <script>
    (function(){
      const hintBtn = document.getElementById('hintBtn');
      const hintArea = document.getElementById('hintArea');
      let hintsGiven = 0;

      hintBtn.addEventListener('click', function(){
        hintsGiven++;
        if(hintsGiven === 1){
          hintArea.textContent = "Hint 1: Check page source comments for reversed-looking alphanumeric strings.";
        } else if (hintsGiven === 2){
          hintArea.textContent = "Hint 2: Inspect computed styles (getComputedStyle(..., '::after')). CSS content may be hex-escaped (\\hh).";
        } else {
          hintArea.textContent = "Hint 3: Combine fragments in order: (reverse-partA) + (CSS-hex-frag-1) + (CSS-hex-frag-2) + (SVG-frag-without-junk), then base64-decode with atob().";
        }
      });

      window.safeCheck = function(){ console.log('This function is safe and does not reveal the flag.'); };
    })();

    // ===== SECURE-FEELING FLAG SUBMIT (no plaintext flag in source) =====
    (function(){
      // STORED_HASH is the SHA-256 hex digest of the correct flag.
      // NOTE: this is one-way; the plaintext flag is NOT included in the page.
      // Replace this digest if you change the canonical flag (see note below).
      const STORED_HASH = 'a633a0ce68a3678d169b034105f52db34dbb51c471ba8594ab985b909f53ed1b';

      const input = document.getElementById('flagInput');
      const btn = document.getElementById('flagSubmit');
      const msg = document.getElementById('flagMsg');

      function hexFromBuffer(buffer){
        const bytes = new Uint8Array(buffer);
        return Array.from(bytes).map(b => b.toString(16).padStart(2,'0')).join('');
      }

      async function sha256Hex(text){
        const data = new TextEncoder().encode(text);
        const digest = await crypto.subtle.digest('SHA-256', data);
        return hexFromBuffer(digest);
      }

      function show(text, ok){
        msg.textContent = text;
        msg.style.color = ok ? '#8ef5b1' : '#ff9aa2';
      }

      btn.addEventListener('click', async function(){
        const val = input.value.trim();
        if(!val){
          show('Please enter a flag.', false);
          return;
        }

        try{
          const h = await sha256Hex(val);
          if(h === STORED_HASH){
            show('Correct flag!', true);
            btn.disabled = true;
            input.disabled = true;
          } else {
            show('Incorrect — try again.', false);
          }
        }catch(e){
          console.error(e);
          show('Error validating flag.', false);
        }
      });

      // allow Enter key to submit
      input.addEventListener('keydown', function(e){
        if(e.key === 'Enter') btn.click();
      });

    })();
  </script>
</body>
</html>
